#!/bin/sh
CONFIG=$1
SOURCE=$2

GIT="git --git-dir=$SOURCE/.git"

# create a second branch
$GIT branch testbranch

$GENCI update $CONFIG

# two lines, since we have two branches now which are untested
[ $($GENCI pending $CONFIG | wc -l) -eq 2 ] || exit 1

# both should be named explicitly
[ ! -z "$($GENCI pending $CONFIG | grep "build master ")" ] || exit 2
[ ! -z "$($GENCI pending $CONFIG | grep "build testbranch ")" ] || exit 3

exit 0
